<div class="container">
  <div class="header">
    <h1>Import Data</h1>
    <div class="connection-info">
      Connected to: {{connectionName}} ({{connectionEndpoint}}:{{connectionPort}} - Namespace: {{connectionNamespace}})
    </div>
  </div>

  <div class="tabs">
    <button id="tab-new" class="tab-button">Create New Table</button>
    <button id="tab-existing" class="tab-button">Load into Existing Table</button>
  </div>

  <!-- CREATE NEW TABLE TAB -->
  <div id="content-new" class="tab-content">
    <div class="info-message">
      Create a new table and import data from a file. Column types will be automatically detected.
    </div>

    <div class="form-group">
      <label for="new-file-input">Data File *</label>
      <div class="file-input-wrapper">
        <input type="text" id="new-file-input" placeholder="Select a file..." readonly required />
        <button type="button" id="browse-new-file-btn">Browse...</button>
      </div>
      <small class="field-hint">
        Supported formats: CSV, JSON, TXT, XLSX
      </small>
    </div>

    <div class="form-group" id="txt-delimiter-group-new" style="display: none;">
      <label for="txt-delimiter-new">TXT Delimiter (for TXT files)</label>
      <select id="txt-delimiter-new">
        <option value=",">Comma (,)</option>
        <option value=";">Semicolon (;)</option>
        <option value="|">Pipe (|)</option>
        <option value="custom">Custom...</option>
      </select>
      <input type="text" id="txt-delimiter-custom-new" placeholder="Enter custom delimiter (e.g., ::)" style="display: none; margin-top: 8px;" maxlength="5" />
      <small class="field-hint">
        Specify the delimiter used in your TXT file
      </small>
    </div>

    <!-- FLEXIBLE SCHEMA SELECTION -->
    <div class="form-group">
      <label for="new-schema-select">Target Schema *</label>
      
      <!-- Schema Dropdown (default) -->
      <div id="new-schema-select-wrapper">
        <div class="search-wrapper">
          <input type="text" id="new-schema-search" placeholder="Filter schemas..." />
          <button type="button" id="search-new-schema-btn" class="search-btn">Load Schemas</button>
        </div>
        <select id="new-schema-select" disabled>
          <option value="">Load schemas first...</option>
        </select>
      </div>

      <!-- Schema Text Input (hidden by default) -->
      <div id="new-schema-text-wrapper" style="display: none;">
        <input type="text" id="new-schema-text-input" placeholder="Enter new schema name... (ex. MyNewSchema_subSchema)" />
      </div>

      <div style="display: flex; gap: 8px; margin-top: 8px; align-items: center;">
        <button type="button" id="new-schema-mode-toggle" class="link-button">Create New Schema</button>
        <small class="field-hint">Switch between selecting existing or creating new</small>
      </div>
    </div>

    <div class="form-group">
      <label for="new-table-name">Table Name *</label>
      <input type="text" id="new-table-name" placeholder="e.g., ImportedData" required />
      <small class="field-hint">
        Name for the new table (will be created)
      </small>
    </div>

    <!-- Column Type Mapping Panel -->
    <div id="column-types-panel" class="column-types-panel" style="display: none;">
      <!-- Populated dynamically after file analysis -->
    </div>

    <div class="button-group">
      <button type="button" id="create-import-btn">Create Table & Import</button>
      <button type="button" id="cancel-btn-new" class="secondary">Cancel</button>
    </div>
  </div>

  <!-- LOAD INTO EXISTING TABLE TAB -->
  <div id="content-existing" class="tab-content">
    <div class="info-message">
      Import data into an existing table. File columns must match table structure.
    </div>

    <div class="form-group">
      <label for="existing-file-input">Data File *</label>
      <div class="file-input-wrapper">
        <input type="text" id="existing-file-input" placeholder="Select a file..." readonly required />
        <button type="button" id="browse-existing-file-btn">Browse...</button>
      </div>
      <small class="field-hint">
        Supported formats: CSV, JSON, TXT, XLSX
      </small>
    </div>

    <div class="form-group" id="txt-delimiter-group-existing" style="display: none;">
      <label for="txt-delimiter-existing">TXT Delimiter (for TXT files)</label>
      <select id="txt-delimiter-existing">
        <option value=",">Comma (,)</option>
        <option value=";">Semicolon (;)</option>
        <option value="|">Pipe (|)</option>
        <option value="custom">Custom...</option>
      </select>
      <input type="text" id="txt-delimiter-custom-existing" placeholder="Enter custom delimiter (e.g., ::)" style="display: none; margin-top: 8px;" maxlength="5" />
      <small class="field-hint">
        Specify the delimiter used in your TXT file
      </small>
    </div>

    <div class="form-group">
      <label for="schema-import">Target Schema *</label>
      <div class="search-wrapper">
        <input type="text" id="schema-search-import" placeholder="Filter schemas..." />
        <button type="button" id="search-schema-btn-import" class="search-btn">Load Schemas</button>
      </div>
      <select id="schema-import" disabled>
        <option value="">Load schemas first...</option>
      </select>
      <small class="field-hint">
        Select the schema containing your target table
      </small>
    </div>

    <div class="form-group">
      <label for="table-import">Target Table *</label>
      <select id="table-import" disabled>
        <option value="">Select a schema first</option>
      </select>
      <small class="field-hint">
        Select the table to import data into
      </small>
    </div>

    <div class="form-group">
      <label>Data Action *</label>
      <div class="radio-group">
        <label class="radio-label">
          <input type="radio" name="data-action" value="append" checked />
          <span>Append to existing data</span>
        </label>
        <label class="radio-label">
          <input type="radio" name="data-action" value="replace" />
          <span>Replace all existing data</span>
        </label>
      </div>
      <small class="field-hint">
        Choose whether to add to or replace existing table data
      </small>
    </div>

    <div class="button-group">
      <button type="button" id="load-existing-btn">Import Data</button>
      <button type="button" id="cancel-btn-existing" class="secondary">Cancel</button>
    </div>
  </div>

  <div class="loading">
    <p>Processing...</p>
  </div>
</div>